# 概述
* an doc readme
## 软件环境
* IDE：MDK-ARM V5
* package version: STM32Cube FW_F4 V1.24.1
* FreeRTOS version: 10.0.1
* CMSIS-RTOS version: 1.02
## 编程规范
* gimbal_task，chassis_task,shoot_task,imu_update_task是强实时性任务，采用os_Delay_until()调度，代码区块使用临界区进行保护， 优先级由高到低排列，禁止被其他任务抢占阻塞
* 其余任务采用os_Delay()调度，实时性受任务时间影响，可以被其他任务抢占
## 陀螺仪校准方法
* 遥控器左摇杆上，右拨杆中，两个摇杆打成内八，维持2秒，进入陀螺仪校准模式，采集陀螺仪数据并写入falsh
## 模块离线说明
* 按照优先级顺序显示LED，当有离线发生，10个LED熄灭， 按照离线顺序显示 若离线，对应的LED亮起 对应关系如下
  | LED点亮  |      对应设备信息 |蜂鸣器状态
  | :--: | :--: |:--:|
  | LED_RED   |     遥控器离线      |连续响4声|
  | LED_GREEN |     云台陀螺仪离线|连续响3声|
  | LED_H			|	    板载陀螺仪离线|连续响3声|
  | LED_G			|		  底盘陀螺仪离线|连续响3声|
  | LED_F			|			yaw轴电机离线|连续响2声|
  | LED_E     |          pitch轴电机离线|连续响2声|
  | LED_D		  |		     拨弹电机离线|连续响2声|
  | LED_C			| 底盘电机离线|连续响2声|
  | LED_B			|				     nuc离线|连续响1声|
  | LED_A			|			     裁判系统离线|连续响1声|
## 操作档位说明
  | 遥控器左拨杆  |  遥控器右拨杆 | 模式说明
  | :--: | :--: |:--:|
  | 上   |   上      |清弹模式|
  | 上   |   中      |锁云台模式|
  | 上   |   下      |补弹模式|
  | 中   |   上      |小陀螺模式|
  | 中   |   中      |底盘跟随模式|
  | 中   |   下      |锁云台模式|
  | 下   |   上      |视觉大符模式|
  | 下   |   中      |视觉打机器人模式|
  | 下   |   下      |比赛模式|

## 程序说明
### 框架说明
* algorithm : 算法实现部分,其中包含PID算法，卡尔曼滤波算法，斜波算法，CRC校验算法，以及自己定义的一些数学函数
* bsp : 对外设的使用的封装部分
* onboard_imu : A板板载陀螺仪的适配包
* modules : 将步兵控制分为5个模块，包括步兵整体模块，底盘模块，云台模块，发射模块，视觉模块，提供模块控制的具体函数实现
* personal : 调试相关上位机的适配包
* tasks : 上层应用任务
* 其余文件夹为CubeMX自动生成
### 软件体系

![程序流程图](C:\Users\zzs\Desktop\流程图.png)

### 硬件体系
1. 主控MCU：STM32F427IIH6 ,运行频率为180MHz
2. 模块通信方式
   * can 通信：电机电调，陀螺仪，裁判系统数据传输
   * pwm 通信：弹仓舵机
3. 上下层通信方式：串口
4. 麦轮安装方式：O型
### 协议数据
协议数据按照通信方向可以分为三大类：
#### 底层发送给上层的数据：
反馈信息：包含各个机构传感器反馈信息、底层计算出来的一些反馈信息；
底层状态信息：包含底层设备运行状态、底层对上层数据的一些响应等；
转发数据：包含裁判系统的全部信息、服务器端的自定义信息；
#### 底层接收的上层数据：
控制信息：上层对底层底盘模块，云台模块，发射模块的控制信息；
#### NUC与主控交互的信息
其中包含识别信息，模式信息；
